<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SAPLEN</title>
<script type="text/javascript" src="js/swfobject.js"></script>
<style type="text/css"> 
/* hide from ie on mac \*/
html {
	height: 100%;
}
flashcontent {
	height: 100%;
}
/* end hide */
body {
	height: 100%;
	margin: 0;
	padding: 0;
}
</style> 
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<iframe id="myFrame" name="myFrame"  frameborder="0"
  style="position:absolute;background-color:transparent;border:0px;display:none;" ></iframe> 
  
<iframe id="googleMap" name="googleMap" frameborder="0"
  style="position:absolute;background-color:transparent;border:0px;display:none;" src="map/googleMap.html">
</iframe>
  
<div id="flashcontent"></div>


<script>			
	var so = new SWFObject('index.swf', 'Flash1', '100%', '100%', "8",'#FFFFFF');
	so.addParam('menu', 'false');
	so.addParam('scale', 'exactfit');//exactfit
	so.addParam('salign', 'top');
	so.addParam('align', 'left');
	so.addParam("wmode","transparent");
    so.addParam('allowScriptAccess', 'always');
    so.write('flashcontent');
    
     function $(id) {
        return document.getElementById(id);
     }
     
     var defaultWidth = 1003;
     var defaultHeight = 613;
      
     function adjustOffset(){
        var offset = {width:defaultWidth,height:defaultHeight};
        var currentHeight = document.body.clientHeight;
        var currentWidth = document.body.clientWidth;
        offset.width = currentWidth/offset.width;
        offset.height = currentHeight/offset.height;
        return offset;
     }
      
     function moveIFrame(x,y,w,h) {  
         //alert(x + "," + y + ":" + w + "," + h);
         var frameRef=$("myFrame");
         var offset = adjustOffset();
         frameRef.style.left= (x * offset.width);  
         frameRef.style.top= (y * offset.height);  
         frameRef.width= (w * offset.width);  
         frameRef.height= (h * offset.height);  
         frameRef.style.display="";
     }  
       
     function loadIFrame(url){  
         var myFrame = $("myFrame");
         myFrame.src=url;
     } 
      
     function hideIFrame(){
         var myFrame = $("myFrame");
         myFrame.style.display="none";
         myFrame.src="";
     }
           
     function moveMap(x,y,w,h) {
         var frameRef=$("googleMap"); 
         frameRef.style.left=x;  
         frameRef.style.top=y;  
         frameRef.width=w;  
         frameRef.height=h;  
         frameRef.style.display="";
      }
      
      function hideMap(){
        var myFrame = $("googleMap");
        myFrame.style.display="none";
      }
      
      function movieTest(info){
      	return "ok";
      }
      
      function moveCenter(address){
      	//alert("address:" + address);
      	callFlashFunc(address);
      }
      
      function callFlashFunc(str)
	  {
	  
	  try{
          
          var frame = frames[1];
          var obj = frame.document.getElementById("GMAP");
          alert(obj);
          if(obj){
          obj.doGeocode(str);
          }
	  }catch(e){alert(e);}
	  }

</script>
</body>
</html>
