<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>SAPLEN</title>
<script type="text/javascript" src="js/swfobject.js"></script>
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<style type="text/css"> 
/* hide from ie on mac \*/
html {
	height: 100%;
}
#flashcontent {
	height: 100%;
}
/* end hide */
body {
	height: 100%;
	margin: 0;
	padding: 0;
}
</style> 
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">

<iframe id="myFrame" name="myFrame"  frameborder="0"
  style="position:absolute;background-color:transparent;border:0px;display:none;" ></iframe> 
  
<div id="googleMap"
  style="position:absolute;background-color:transparent;border:0px;width:236px;height:208px;display:none;" >
</div>

  
<div id="flashcontent"></div>


<script>
	var iframeSrcLeft = 0;
	var iframeSrcTop = 0;
	var iframeSrcWidth = 0;
	var iframeSrcHeight = 0;

	var gmapSrcLeft = 0;
	var gmapSrcTop = 0;
	var gmapSrcWidth = 0;
	var gmapSrcHeight = 0;

	var so = new SWFObject('index.swf', 'Flash1', '100%', '100%', "8",'#FFFFFF');
	so.addParam('menu', 'false');
	so.addParam('scale', 'exactfit');//exactfit
	so.addParam('salign', 'top');
	so.addParam('align', 'left');
	so.addParam("wmode","transparent");
    so.addParam('allowScriptAccess', 'always');
    so.write('flashcontent');
    
    var go = new SWFObject('map/googleMap.swf', 'GMAP', '100%', '100%', "8",'#FFFFFF');
	go.addParam('menu', 'false');
	go.addParam('scale', 'exactfit');
	go.addParam('salign', 'top');
	go.addParam('align', 'middle');
	go.addParam("wmode","transparent");
    go.addParam('allowScriptAccess', 'always');
    go.write('googleMap');

     var defaultWidth = 1003;
     var defaultHeight = 613;
      
     function adjustOffset(){
        var offset = {width:defaultWidth,height:defaultHeight};
        var currentHeight = document.body.clientHeight;
        var currentWidth = document.body.clientWidth;
        offset.width = currentWidth/offset.width;
        offset.height = currentHeight/offset.height;
        return offset;
     }

	 function initIFrame(x,y,w,h) {
		iframeSrcLeft = x;
		iframeSrcTop = y;
		iframeSrcWidth = w;
		iframeSrcHeight = h;
	 }

	 function resizeIFrame() {
	     var frameRef=$("#myFrame");
		 var offset = adjustOffset();
		 frameRef.css('left', (iframeSrcLeft * offset.width));  
         frameRef.css('top', (iframeSrcTop * offset.height));  
         frameRef.css('width', (iframeSrcWidth * offset.width));  
         frameRef.css('height', (iframeSrcHeight * offset.height));  
	 }
      
     function moveIFrame(x,y,w,h) {  
         //alert(x + "," + y + ":" + w + "," + h);
		 initIFrame(x,y,w,h);
         var frameRef=$("#myFrame");
         var offset = adjustOffset();
         frameRef.css('left', (x * offset.width));  
         frameRef.css('top', (y * offset.height));  
         frameRef.css('width', (w * offset.width));  
         frameRef.css('height', (h * offset.height)); 
         frameRef.show();
     }  
       
     function loadIFrame(url){  
         var myFrame = $("#myFrame");
         myFrame.attr('src',url);
     } 
      
     function hideIFrame(){
         var myFrame = $("#myFrame");
         myFrame.hide();
         myFrame.attr('src',"");
     }
     
	 function initMap(x,y,w,h) {
		gmapSrcLeft = x;
		gmapSrcTop = y;
		gmapSrcWidth = w;
		gmapSrcHeight = h;
	 }
		   
     function moveMap(x,y,w,h) {
		 initMap(x,y,w,h);
         var frameRef=$("#googleMap"); 
		 var offset = adjustOffset();
         frameRef.css('left', (x * offset.width));  
         frameRef.css('top', (y * offset.height));  
         frameRef.css('width', (w * offset.width));  
         frameRef.css('height', (h * offset.height));  
         frameRef.show();
      }

	  function resizeGMAP() {
	     var frameRef=$("#googleMap"); 
		 var offset = adjustOffset();
		 frameRef.css('left', (gmapSrcLeft * offset.width));  
         frameRef.css('top', (gmapSrcTop * offset.height));  
         frameRef.css('width', (gmapSrcWidth * offset.width));  
         frameRef.css('height', (gmapSrcHeight * offset.height));  
	 }
      
      function hideMap(){
        var myFrame = $("#googleMap");
        myFrame.hide();
      }
      
      function movieTest(info){
      	return "ok";
      }
      
      function moveCenter(address){
      	//alert("address:" + address);
      	callFlashFunc(address);
      }
      
      function callFlashFunc(str)
	  {
	  var obj = $("GMAP");
	  obj.doGeocode(str);
	  }

	  $(window).resize(function(){
			try{
			resizeIFrame();
			resizeGMAP();
			} catch (e) {
				//alert(e);
			}
	  });
</script>
</body>
</html>
